(this["webpackJsonpindaba-transcription"]=this["webpackJsonpindaba-transcription"]||[]).push([[0],{119:function(e,t,a){e.exports=a(169)},124:function(e,t,a){},125:function(e,t,a){},169:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),i=a(17),o=a.n(i),l=(a(124),a(125),a(60)),s=a(101),c=a(102),u=a(112),p=a(103),m=a(113),h=a(41),d=a(6),f=a(211),k=a(212),g=a(204),E=a(208),y=a(207),b=a(209),v=a(210);function w(e){var t=~~e%60,a="";return a+=~~(e%3600/60)+":"+(t<10?"0":""),a+=""+t}var C=Object(d.a)({root:{display:"flex",flexWrap:"nowrap",justifyContent:"space-around",overflow:"hidden"},gridList:{flexWrap:"nowrap",transform:"translateZ(0)",spacing:10},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}})((function(e){var t=e.classes,a=e.chunks,i=Object(n.useRef)(null);return r.a.createElement("div",{className:t.root},r.a.createElement("div",{ref:i,style:{overflowX:"auto",width:"100%",whiteSpace:"nowrap"}},a.map((function(t){return r.a.createElement(g.a,{onClick:function(){return e.onPlay(t.starttime)},style:{display:"inline-block",margin:"0.2em"}},r.a.createElement(y.a,null,r.a.createElement(E.a,null,r.a.createElement("h2",{style:{textAlign:"center"}},w(t.starttime)," - ",w(t.endtime)))),r.a.createElement(b.a,{disableSpacing:!0},r.a.createElement(v.a,{size:"small",color:"primary",onClick:function(){return e.onPlay(t.starttime)}},r.a.createElement(f.a,null)),r.a.createElement(v.a,{size:"small",color:"primary",onClick:function(){return e.onDelete(t.starttime,t.endtime)}},r.a.createElement(k.a,null))))}))))})),S=a(223),O=a(214),j=a(225),B=a(215),x=a(216),I=a(221),D=a(107),N=a.n(D),P=a(108),T=a.n(P),W=a(109),J=a.n(W),M=a(213),z={avatar:{backgroundColor:M.a[100],color:M.a[600]}};var R=Object(d.a)(z)((function(e){var t=e.classes,a=e.open,n=e.options;return r.a.createElement(I.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:a},r.a.createElement(O.a,null,n.map((function(a){return r.a.createElement(j.a,{button:!0,onClick:function(){return e.onClose(a)},key:a},r.a.createElement(B.a,null,r.a.createElement(S.a,{className:t.avatar},function(e){switch(e){case 0:return r.a.createElement(N.a,null);case 1:return r.a.createElement(T.a,null);case 2:return r.a.createElement(J.a,null)}}(n.indexOf(a)))),r.a.createElement(x.a,{primary:a}))}))))})),A=a(59),H=a.n(A),$=a(217),q=a(218),F=a(111),L=a.n(F),V=a(110),X=a.n(V),Z=a(222),G=a(219),K=function(e){function t(e,a){var n;return Object(s.a)(this,t),(n=Object(u.a)(this,Object(p.a)(t).call(this,e,a))).handlePlay=function(e){n.player.seek(e),n.player.play()},n.skipBack=function(){var e=n.player.getState().player;n.player.seek(e.currentTime-2)},n.backButton=function(){window.history.back()},n.handleDelete=function(e,t){var a=n.state.original,r=a.transcription.chunks.filter((function(t){return t.starttime!==e})),i=n.state.original.transcription.chunks.findIndex((function(e){return e.starttime===t}));i>=1&&(r[--i].starttime=e),a.transcription.chunks=r,n.setState({original:a}),n.saveEdit()},n.handleClickOpen=function(){n.handleConfirm()},n.handleClose=function(e){switch(n.setState({open:!1}),e){case n.state.options[0]:var t=n.player.getState().player;n.player.seek(t.currentTime-2);break;case n.state.options[1]:n.handleConfirm()}},n.closeError=function(){n.setState({erroropen:!1})},n.state={original:{transcription:{chunks:[]}},source:e.src,open:!1,options:["Backward 2 Seconds","Add New Breakpoint","Discard Setting"],erroropen:!1},n}return Object(m.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.player.subscribeToStateChange(this.handleStateChange.bind(this)),this.serverRequest=H.a.get("/api/watch/edit/"+this.props.id).then(function(e){e.data.transcription||(e.data.transcription={chunks:[]}),e.data.transcription.chunks.forEach((function(e){e.starttime=Q(e.starttime),e.endtime=Q(e.endtime)})),console.log(e.data),this.setState({original:e.data})}.bind(this))}},{key:"handleStateChange",value:function(e){this.setState({player:e})}},{key:"saveEdit",value:function(){for(var e=[],t=Object.assign({},this.state.original.transcription).chunks,a=0;a<t.length;a++){var n={};n.starttime=U(Object(l.a)({},t[a]).starttime),n.endtime=U(Object(l.a)({},t[a]).endtime),e.push(n)}console.log("newchunks: ",e);var r=JSON.stringify(this.state.original),i=JSON.parse(r);i.transcription.chunks=e,H.a.post("/api/watch/savedit/"+this.props.id+"?apikey="+this.props.apikey,i).then((function(e){console.log(e)}))}},{key:"handleConfirm",value:function(){var e=this.state.player.currentTime,t=Object.assign({},this.state.original),a={endtime:e},n=t.transcription.chunks.findIndex((function(t){return e>=t.starttime&&e<=t.endtime}));if(0!=e){if(n>=1)t.transcription.chunks[n].starttime=e,a.starttime=t.transcription.chunks[--n].endtime,t.transcription.chunks.splice(++n,0,a);else if(0===n)t.transcription.chunks[n].starttime=e,a.starttime=0,t.transcription.chunks.splice(n,0,a);else{var r=t.transcription.chunks.slice(-1)[0];a.starttime=r?r.endtime:0,t.transcription.chunks.push(a)}console.log("Original: ",t),this.setState({original:t}),this.saveEdit()}else this.setState({erroropen:!0})}},{key:"render",value:function(){var e=this;return r.a.createElement("div",null,r.a.createElement("br",null),r.a.createElement("h2",{style:{position:"absolute",width:"15%",right:"1em",top:"3em"}},"Create a breakpoint when someone stops talking"),r.a.createElement($.a,{style:{maxWidth:"800px"}},r.a.createElement(h.Player,{ref:function(t){e.player=t}},r.a.createElement("source",{src:this.state.source}),r.a.createElement(h.BigPlayButton,{position:"center"}),r.a.createElement(h.Shortcut,{clickable:!0}),r.a.createElement(h.ControlBar,{autoHide:!1}))),r.a.createElement("br",null),r.a.createElement(C,{style:{width:"100%"},onPlay:this.handlePlay,onDelete:this.handleDelete,chunks:this.state.original.transcription.chunks}),r.a.createElement(R,{open:this.state.open,options:this.state.options,onClose:this.handleClose}),r.a.createElement("div",{id:"output"}),r.a.createElement(q.a,{color:"primary",onClick:this.skipBack,"aria-label":"left",style:{position:"absolute",left:"2em",top:"45%"}},r.a.createElement(X.a,null)),r.a.createElement(q.a,{color:"primary",onClick:this.handleClickOpen,"aria-label":"add",style:{position:"absolute",right:"1em",top:"45%"}},r.a.createElement(L.a,null)),r.a.createElement(v.a,{onClick:this.backButton,style:{position:"absolute",left:"0",top:"1em"}},r.a.createElement(G.a,null)),r.a.createElement(Z.a,{anchorOrigin:{vertical:"bottom",horizontal:"center"},open:this.state.erroropen,autoHideDuration:1e3,onClose:this.closeError,message:"Cannot add breakpoint here"}))}}]),t}(n.Component);function Q(e){if(!isNaN(e))return e;var t=e.match(/^(?:(\d{2,}):)?(\d{2}):(\d{2})[,.](\d{3})$/);if(!t)throw new Error('Invalid SRT or VTT time format: "'+e+'"');return((t[1]?36e5*parseInt(t[1],10):0)+6e4*parseInt(t[2],10)+1e3*parseInt(t[3],10)+parseInt(t[4],10))/1e3}function U(e){console.log("duration: "+e);var t=1e3*e,a=parseInt(parseFloat(t)%1e3/100),n=Math.floor(t/1e3%60),r=Math.floor(t/6e4%60),i=Math.floor(t/36e5%24);return console.log(a),a=a<10?"00"+a:"0"+a,i=i<10?"0"+i:i,r=r<10?"0"+r:r,n=n<10?"0"+n:n,console.log(i+":"+r+":"+n+","+a),i+":"+r+":"+n+","+a}var Y=a(224);var _=function(){var e=window.location.href.split("/")[5].split("?")[0],t=window.location.href.split("apikey=")[1];return r.a.createElement("main",null,r.a.createElement($.a,{maxWidth:"lg"},r.a.createElement(Y.a,null),r.a.createElement(K,{src:"/api/watch/getvideo/"+e,id:e,apikey:t})))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(168);o.a.render(r.a.createElement(_,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[119,1,2]]]);
//# sourceMappingURL=main.00ac24cf.chunk.js.map