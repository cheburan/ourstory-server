(this["webpackJsonpindaba-transcription"]=this["webpackJsonpindaba-transcription"]||[]).push([[0],{107:function(e,t,a){e.exports=a(157)},112:function(e,t,a){},113:function(e,t,a){},157:function(e,t,a){"use strict";a.r(t);var n=a(0),i=a.n(n),r=a(15),s=a.n(r),o=(a(112),a(113),a(92)),c=a(93),l=a(99),u=a(94),p=a(100),m=a(35),h=a(195),d=a(6),f=a(184),k=a(196),g=a(187),v=a(188),y=a(40),E=a.n(y);function b(e){var t=~~e%60,a="";return a+=~~(e%3600/60)+":"+(t<10?"0":""),a+=""+t}var T=Object(d.a)({root:{display:"flex",flexWrap:"wrap",justifyContent:"space-around",overflow:"hidden"},gridList:{flexWrap:"nowrap",transform:"translateZ(0)"},titleBar:{background:"linear-gradient(to top, rgba(0,0,0,0.7) 0%, rgba(0,0,0,0.3) 70%, rgba(0,0,0,0) 100%)"}})((function(e){var t=e.classes,a=e.chunks;return i.a.createElement("div",{className:t.root},i.a.createElement(f.a,{className:t.gridList,cols:3},a.map((function(a){return i.a.createElement(k.a,{onClick:function(){return e.onPlay(a.startTime)},key:a.startTime},i.a.createElement("img",{src:a.img,alt:a.startTime}),i.a.createElement(g.a,{title:b(a.startTime)+" ~ "+b(a.endTime),classes:{root:t.titleBar},actionIcon:i.a.createElement(v.a,{"aria-label":"star ".concat(a.startTime)},i.a.createElement(E.a,{onClick:function(){return e.onDelete(a.startTime,a.endTime)}}))}))}))))})),w=a(194),C=a(190),S=a(191),O=a(192),B=a(197),j=a(193),N=a(97),x=a.n(N),D=a(98),P=a.n(D),I=a(189),W={avatar:{backgroundColor:I.a[100],color:I.a[600]}};var J=Object(d.a)(W)((function(e){var t=e.classes,a=e.open,n=e.options;return i.a.createElement(j.a,{onClose:e.onClose,"aria-labelledby":"simple-dialog-title",open:a},i.a.createElement(C.a,null,n.map((function(a){return i.a.createElement(S.a,{button:!0,onClick:function(){return e.onClose(a)},key:a},i.a.createElement(O.a,null,i.a.createElement(w.a,{className:t.avatar},function(e){switch(e){case 0:return i.a.createElement(x.a,null);case 1:return i.a.createElement(P.a,null);case 2:return i.a.createElement(E.a,null)}}(n.indexOf(a)))),i.a.createElement(B.a,{primary:a}))}))))})),L=a(51),q=a.n(L),A=function(e){function t(e,a){var n;return Object(o.a)(this,t),(n=Object(l.a)(this,Object(u.a)(t).call(this,e,a))).handlePlay=function(e){n.player.seek(e),n.player.play()},n.handleDelete=function(e,t){var a=n.state.original.transcription.chunks.filter((function(t){return t.startTime!==e})),i=n.state.original.transcription.chunks.findIndex((function(e){return e.startTime===t}));i>=1&&(a.transcription.chunks[--i].startTime=e),n.setState({original:a}),n.saveEdit()},n.handleClickOpen=function(){n.player.pause(),n.setState({open:!0})},n.handleClose=function(e){switch(n.setState({open:!1}),e){case n.state.options[0]:var t=n.player.getState().player;n.player.seek(t.currentTime-2);break;case n.state.options[1]:n.handleConfirm()}},n.state={original:{transcription:{chunks:[]}},source:e.src,open:!1,options:["Backward 2 Seconds","Add New Breakpoint","Discard Setting"]},n}return Object(p.a)(t,e),Object(c.a)(t,[{key:"componentDidMount",value:function(){this.player.subscribeToStateChange(this.handleStateChange.bind(this)),this.serverRequest=q.a.get("/api/watch/edit/"+this.props.id).then(function(e){console.log(e),e.data.transcription||(e.data.transcription={chunks:[]}),this.setState({original:e.data})}.bind(this))}},{key:"handleStateChange",value:function(e){this.setState({player:e})}},{key:"saveEdit",value:function(){q.a.post("/api/watch/savedit/"+this.props.id+"?apikey="+this.props.apikey,this.state.original).then((function(e){console.log(e)}))}},{key:"handleConfirm",value:function(){var e=this.state.player.currentTime,t=this.state.original,a={img:"/transcription/step1/build/static/images/grid-list/default.jpg",endTime:e},n=this.state.original.transcription.chunks.findIndex((function(t){return e>=t.startTime&&e<=t.endTime}));if(n>=1)t.transcription.chunks[n].startTime=e,a.startTime=t.transcription.chunks[--n].endTime,t.transcription.chunks.splice(++n,0,a);else if(0===n)t.transcription.chunks[n].startTime=e,a.startTime=0,t.transcription.chunks.splice(n,0,a);else{var i=t.transcription.chunks.slice(-1)[0];a.startTime=i?i.endTime:0,t.transcription.chunks.push(a)}this.setState({original:t}),this.saveEdit()}},{key:"render",value:function(){var e=this;return i.a.createElement("div",null,i.a.createElement(m.Player,{ref:function(t){e.player=t}},i.a.createElement("source",{src:this.state.source}),i.a.createElement(m.BigPlayButton,{position:"center"}),i.a.createElement(m.Shortcut,{clickable:!0}),i.a.createElement(m.ControlBar,{autoHide:!1})),i.a.createElement("div",{className:"py-3"},i.a.createElement(h.a,{onClick:this.handleClickOpen,className:"m-2"},"Set Breakpoint"),i.a.createElement(T,{onPlay:this.handlePlay,onDelete:this.handleDelete,chunks:this.state.original.transcription.chunks}),i.a.createElement(J,{open:this.state.open,options:this.state.options,onClose:this.handleClose}),i.a.createElement("div",{id:"output"}),i.a.createElement("div",null,JSON.stringify(this.state.original))))}}]),t}(n.Component);var H=function(){var e=window.location.href.split("/")[5].split("?")[0],t=window.location.href.split("apikey=")[1];return i.a.createElement("main",{className:"container mt-3"},i.a.createElement(A,{src:"/api/watch/getvideo/"+e,id:e,apikey:t}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(155),a(156);s.a.render(i.a.createElement(H,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))}},[[107,1,2]]]);
//# sourceMappingURL=main.f50618b0.chunk.js.map